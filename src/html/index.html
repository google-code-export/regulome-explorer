<html>
    <head>
        <title>Pages</title>

        <link rel="shortcut icon" href="https://informatics-apps.systemsbiology.net/addama/ui/isbfavicon.ico" type="image/x-icon"/>

        <script type="text/javascript" src="https://informatics-apps.systemsbiology.net/jquery-1.6.4/jquery-1.6.4.js"></script>
        <script type="text/javascript" src="http://www.ajaxblender.com/script-sources/xbreadcrumbs/xbreadcrumbs.js"></script>
        <link rel="stylesheet" type="text/css" href="http://www.ajaxblender.com/script-sources/xbreadcrumbs/xbreadcrumbs.css"/>
        
        <link rel="stylesheet" type="text/css" href="https://informatics-apps.systemsbiology.net/ext-js-3.4.0/resources/css/ext-all.css"/>
        <link rel="stylesheet" type="text/css" href="https://informatics-apps.systemsbiology.net/ext-js-3.4.0/examples/shared/examples.css"/>
        <link rel="stylesheet" type="text/css" href="https://informatics-apps.systemsbiology.net/ext-js-3.4.0/resources/css/xtheme-gray.css"/>

        <script type="text/javascript" src="https://informatics-apps.systemsbiology.net/ext-js-3.4.0/adapter/jquery/ext-jquery-adapter.js"></script>
        <script type="text/javascript" src="https://informatics-apps.systemsbiology.net/ext-js-3.4.0/ext-all.js"></script>

        <script type="text/javascript" src="https://addama.googlecode.com/svn/tags/2.1/user-interfaces/src/main/html/addama/ui/console_handling.js"></script>
        <script type="text/javascript" src="https://addama.googlecode.com/svn/tags/2.1/user-interfaces/src/main/html/addama/ui/query_parameters.js"></script>

        <script type="text/javascript" src="js/scriptLoad.js"></script>
        <script type="text/javascript" src="js/messageBus.js"></script>
        <script type="text/javascript" src="js/notes.js"></script>
        <script type="text/javascript" src="js/pages.js"></script>
        <script type="text/javascript" src="js/menus.js"></script>
        <link rel="stylesheet" type="text/css" href="css/stylesheet.css"/>
        
        <script type="text/javascript">
            function OpenMainDialog() {
                alert("this is the main dialog");
            }

            function AlertSignIn() {
                alert("Sign in");
            }

            function ShowNotes() {
                var url = get_parameter("URI");
                if (url) {
                    new org.systemsbiology.pages.apis.notes.Editor({
                        notesUrl: url.replace(".json", ".txt"),
                        contentEl: "c_noteseditor"
                    });
                }
            }

            function ShowLoadedJson(o) {
                var json = Ext.util.JSON.decode(o.responseText);
                if (json.items) {
                    var html = "";
                    Ext.each(json.items, function(item) {
                        html += '<li><a href="' + document.location + '?URI=' + item.uri + '">' + item.label + '</a></li>';
                    });

                    var menus = [
                        {el: "li-homemenu",spec: org.systemsbiology.pages.apis.menus.homemenu},
                        {el: "li-viewmenu", spec: org.systemsbiology.pages.apis.menus.viewmenu},
                        {el: "li-filtermenu", spec: org.systemsbiology.pages.apis.menus.filtermenu}
                    ];

                    Ext.each(menus, function(item) {
                        if (Ext.getDom(item.el) === null) {
                            var menu_html = org.systemsbiology.pages.apis.menus.GetMenuHtml(item.spec, item.el);
                            Ext.DomHelper.append("ul-containermenu", menu_html);
                        }
                    });

                    $('#ul-containermenu').xBreadcrumbs();
                    Ext.getDom("c_label").innerHTML = "<b>List of Configurations</b>";
                    Ext.getDom("c_parentContainer").innerHTML = "<ul>" + html + "</ul>";
                } else {
                    Ext.getDom("c_label").innerHTML = "<b>" + (json.title ? json.title : "Untitled") + "</b>";
                    Ext.get("c_notes").show();
                    org.systemsbiology.pages.apis.containers.LoadConfiguration(json, "c_parentContainer");
                }
            }

            function LoadData() {
                var url = get_parameter("URI");
                if (url) {
                    Ext.Ajax.request({ url: url, method: "GET", success: ShowLoadedJson });
                } else {
                    Ext.Ajax.request({ url: "/configs/all.json", method: "GET", success: ShowLoadedJson });
                }
            }
            
            Ext.onReady(LoadData);
        </script>
    </head>
    <body>
    <div id="div-header">
        <div id="div-topnav">
            <ul>
                <li><a href="http://systemsbiology.org" target="_blank">Institute for Systems Biology</a></li>
                <li><a href="http://cancergenome.nih.gov/" target="_blank">TCGA Cancer Genome Atlas</a></li>
                <li><a href="http://cancerregulome.org" target="_blank">Cancer Regulome</a></li>
                <li><a href="#" onclick="AlertSignIn(); return false;">Sign In</a></li>
            </ul>
        </div>
        <div id="div-logomenu">
            <div id="div-logomenu-top-spacer"></div>
            <div id="div-logomenu-center">
                <div id="div-logomenu-dropdowns">
                    <ul class="xbreadcrumbs" id="ul-containermenu"></ul>
                </div>

                <a href="#" class="sharelink">Share</a>
            </div>
            <div id="div-logomenu-bottom-spacer"></div>
            <div id="div-logomenu-left">
                <a href="#" onclick="OpenMainDialog(); return false;"><img src="/images/isblogo.png"/></a>
            </div>
        </div>
    </div>
    <div id="c_main">
        <div id="c_label"></div>
        <div id="c_parentContainer"></div>

        <div id="c_notes" style="display:none">
            <a href="#" onclick="ShowNotes(); return false;">Notes</a>
            <div id="c_noteseditor"></div>
        </div>
    </div>
    </body>
</html>
